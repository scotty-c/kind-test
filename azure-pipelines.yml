trigger:
  branches:
    include:
      - master

pool:
  vmImage: 'Ubuntu 16.04'

variables:
  GOPATH: '$(Agent.BuildDirectory)/gopath' # Go workspace path
  GOROOT: '$(Agent.BuildDirectory)/go' # Go installation path
  GOBIN:  '$(GOPATH)/bin' # Go binaries path
  modulePath: '$(GOPATH)/src/github.com/$(build.repository.name)' # Path to the module's code

steps:
- script: GO111MODULE="on" go get sigs.k8s.io/kind@v0.4.0
  displayName: 'Install kind'

- script: kind create cluster
  displayName: 'Deploying kind cluster'

- script: export KUBECONFIG="$(kind get kubeconfig-path --name="kind")" && kubectl cluster-info
  displayName: 'Show cluster info'